\documentclass{standalone}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,shapes,shapes.geometric,shadows}
\usetikzlibrary{positioning}

\begin{document}
    
\begin{tikzpicture}[]

	%  ただの線　
  % \draw [very thick, -, dotted] (-2.0cm, 1.3cm) -- (12.5cm, 1.3cm);
	%  Training 囲い
	\draw[thick, dashed, rounded corners=10pt, distance=1pt] (-2.5,1.2)--(-2.5,5.5)--(14.7,5.5)--(14.7,1.2)-- cycle;
	\node (train) at (6.0cm, 5.2cm) [align=center]{\textbf{Training phase}};

	\node (cover) at (-1cm, 4.8cm) {\includegraphics[scale=1.0]{./android.eps}};
  \coordinate (return) at (-1.0cm, 4.4cm) node at (return) [below] {Benign Apps};

	\node (cover) at (-1.5cm, 3.6cm) {\includegraphics[scale=0.5]{./virus.eps}};
	\node (cover) at (-1cm, 3.3cm) {\includegraphics[scale=1.0]{./android.eps}};
  \coordinate (return) at (-1.0cm, 2.9cm) node at (return) [below] {Malware Samples};

	%  上　左1
	\node at (0.3cm, 3.8cm)[single arrow, draw=black, fill=white, 
      minimum width = 10pt, single arrow head extend=3pt,
      minimum height=10mm] {}; % length of arrow
 %  Pair Extraction
  \tikzset{Process/.style={rectangle,  draw,  text centered, text width=2.5cm, minimum height=1.0cm}};
  \node [Process, fill=white] (train) at (2.4cm, 3.8cm) [align=center] {Permission Pair \\Extraction};
  % \draw [ultra thick, ->, dashed] (-0.5cm, 5cm) -- (1.5cm, 5cm);

  \draw [very thick, - ] (2.0cm, 3.0cm) -- (2.0cm, 2.4cm); % 下向き線
  \draw [very thick, ->] (2.0cm, 2.4cm) -- (2.5cm, 2.4cm); % 右横矢印

	% CR based DB
  \node (cover_s) at (3.0cm, 2.8cm) {\includegraphics[scale=0.7]{./database_w.eps}};
	% \node (ext_call) at (3.0cm, 3.1cm) [align=center] {AP};
  \node (cover_s) at (3.5cm, 2.8cm) {\includegraphics[scale=0.7]{./database_w.eps}};
	% \node (ext_call) at (3.5cm, 3.1cm) [align=center] {DP};
  \node (cover_s) at (4.0cm, 2.8cm) {\includegraphics[scale=0.7]{./database_w.eps}};
	% \node (ext_call) at (4.0cm, 3.1cm) [align=center] {CP};
  \node (cover_s) at (4.5cm, 2.8cm) {\includegraphics[scale=0.7]{./database_w.eps}};
	% \node (ext_call) at (4.5cm, 3.1cm) [align=center] {All};
  \node (cover_s) at (3.2cm, 2.5cm) {\includegraphics[scale=0.058]{./white_background.pdf}};
  \node (cover_s) at (3.2cm, 2.5cm) {\includegraphics[scale=0.7]{./database_b.eps}};
  \node (cover_s) at (3.7cm, 2.5cm) {\includegraphics[scale=0.058]{./white_background.pdf}};
  \node (cover_s) at (3.7cm, 2.5cm) {\includegraphics[scale=0.7]{./database_b.eps}};
  \node (cover_s) at (4.2cm, 2.5cm) {\includegraphics[scale=0.058]{./white_background.pdf}};
  \node (cover_s) at (4.2cm, 2.5cm) {\includegraphics[scale=0.7]{./database_b.eps}};
  \node (cover_s) at (4.7cm, 2.5cm) {\includegraphics[scale=0.058]{./white_background.pdf}};
  \node (cover_s) at (4.7cm, 2.5cm) {\includegraphics[scale=0.7]{./database_b.eps}};
  % \node (cover_s) at (4.1cm, 2.6cm) {\includegraphics[scale=1.0]{./database_b.eps}};
	\node (ext_call) at (3.9cm, 1.7cm) [align=center] {CR based Databases \\(Algorithm 1)};
  % \tikzset{Process/.style={rectangle,  draw, text centered, text width=3.7cm, minimum height=0.3cm}};
	% \node [Process, fill=white] (train) at (3.4cm, 1.8cm) [align=center] {CR based Databases (Algorithm 1)};

	\draw [very thick, -] (5.3cm, 2.5cm) -- (7.0cm, 2.5cm);
  \draw [very thick, ->] (7.0cm, 2.5cm) -- (7.0cm, 3.2cm); % 上
  \draw [very thick, -] (5.3cm, 2.3cm) -- (7.0cm, 2.3cm);
  \draw [very thick, ->] (7.0cm, 2.3cm) -- (7.0cm, 0.8cm); % 下

	%  上　左2
	\node at (4.4cm, 3.8cm)[single arrow, draw=black, fill=white, 
      minimum width = 10pt, single arrow head extend=3pt,
      minimum height=10mm] {}; % length of arrow

	%  Score Calculation 
  % \tikzset{Process/.style={rectangle,  draw,  text centered, text width=1.8cm, minimum height=1.0cm}};
  % \node [Process, fill=white] (train) at (5.5cm, 3.8cm) [align=center] {Score Calculation};
  \tikzset{Process/.style={rectangle,  draw,  text centered, text width=2.8cm, minimum height=1.0cm}};
	\node [Process, fill=white] (train) at (6.7cm, 3.8cm) [align=center] {Score Calculation (Algorithm 2)};

	%  上　左3
	\node at (8.8cm, 3.8cm)[single arrow, draw=black, fill=white, 
      minimum width = 10pt, single arrow head extend=3pt,
      minimum height=10mm] {}; % length of arrow
  \node (f) at (8.9cm, 3.2cm) [align=center] {Feature \\Vector};

	%  Training
  \tikzset{Process/.style={rectangle,  draw,  text centered, text width=1.5cm, minimum height=1.0cm}};
  \node [Process, fill=white] (train) at (10.5cm, 3.8cm) [align=center] {Training}; 
	\node (cover) at (12.3cm, 4.3cm) {\includegraphics[scale=1.5]{./model_w.eps}};
  \node (f) at (12.3cm, 3.2cm) [align=center] {ML based \\Classifier};
  % \coordinate (return) at (11.8cm, 3.2cm) node at (return) [below] {};

	% trainingの下の矢印
  \draw [very thick, ->] (10.5cm, 3.2cm) -- (10.5cm, 0.8cm); 

	\node (cover) at (-1cm, 0.2cm) {\includegraphics[scale=1.0]{./android.eps}};
  \coordinate (return) at (-1.0cm, -0.2cm) node at (return) [below] {Testing Apps};

	%  下　左1
	\node at (0.3cm, 0.2cm)[single arrow, draw=black, fill=white, 
      minimum width = 10pt, single arrow head extend=3pt,
      minimum height=10mm] {}; % length of arrow

  \tikzset{Process/.style={rectangle,  draw,  text centered, text width=2.5cm, minimum height=1.0cm}};
  \node [Process, fill=white] (train) at (2.4cm, 0.2cm) [align=center] {Permission Pair \\Extraction};
  % \draw [ultra thick, ->, dashed] (-0.5cm, 5cm) -- (1.5cm, 5cm);

	%  下　左2
	\node at (4.4cm, 0.2cm)[single arrow, draw=black, fill=white, 
      minimum width = 10pt, single arrow head extend=3pt,
      minimum height=10mm] {}; % length of arrow

	%  Score Calculation 
  \tikzset{Process/.style={rectangle,  draw,  text centered, text width=2.8cm, minimum height=1.0cm}};
	\node [Process, fill=white] (train) at (6.7cm, 0.2cm) [align=center] {Score Calculation (Algorithm 2)};

	%  下　左3
	\node at (8.8cm, 0.2cm)[single arrow, draw=black, fill=white, 
      minimum width = 10pt, single arrow head extend=3pt,
      minimum height=10mm] {}; % length of arrow
  \node (f) at (8.9cm, -0.5cm) [align=center] {Feature \\Vector};

	%  Detection Model 
  \tikzset{Process/.style={rectangle,  draw,  text centered, text width=1.5cm, minimum height=1.0cm}};
  \node [Process, fill=white] (train) at (10.5cm, 0.2cm) [align=center] {Detection Model};

	%  下　左4
	\node at (12.0cm, 0.2cm)[single arrow, draw=black, fill=white, 
      minimum width = 10pt, single arrow head extend=3pt,
      minimum height=10mm] {}; % length of arrow

  \node (malware) at (13.6cm, 0.2cm) [align=center] {Benign\ apps\\ or\\ Malware};
  % \node (malware) at (11.8cm, 0.2cm) [align=center] {Benign\\ or\\ Malicious};

	%  Testing 囲い
	\draw[thick, dashed, rounded corners=10pt, distance=1pt] (-2.5,-1.3)--(-2.5,1.0)--(14.7,1.0)--(14.7,-1.3)-- cycle;
	\node (train) at (6.0cm, -1.0cm) [align=center]{\textbf{Testing phase}};

\end{tikzpicture}

\end{document}
